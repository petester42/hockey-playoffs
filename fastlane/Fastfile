fastlane_version "0.12.4"

default_platform :ios

platform :ios do

  before_all do
    sh 'cd .. && bundle exec pod install'
  end

  desc "Sets up project"
  lane :setup do

  end

  desc "Runs all the tests"
  lane :test do
    xctest scheme: "HockeyPlayoffs", destination: "OS=8.4,name=iPhone 6", clean: true
  end

  desc "Runs all the tests and generates a coverage report"
  lane :coverage do
    xctest scheme: "HockeyPlayoffs", destination: "OS=8.4,name=iPhone 6", clean: true
    sh 'cd .. && bundle exec slather coverage -h --output-directory build/coverage --show'
  end

  desc "Submit a new Beta Build to Apple TestFlight"
  lane :beta do
    snapshot
    cert
    sigh
    gym scheme: "HockeyPlayoffs"
    deliver beta: true, skip_deploy: false
    clean_build_artifacts
  end

  desc "Deploy a new version to the App Store"
  lane :deploy do
    snapshot
    cert
    sigh
    gym scheme: "HockeyPlayoffs"
    deliver force: true, skip_deploy: true
    clean_build_artifacts
  end

end
